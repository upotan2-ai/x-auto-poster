/**
 * ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç®¡ç†ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
 * æŠ•ç¨¿ãƒ†ãƒ¼ãƒžã®ç®¡ç†ã¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”Ÿæˆã‚’è¡Œã†
 */

/** æŠ•ç¨¿ãƒ†ãƒ¼ãƒžã®å®šç¾© */
interface PostTheme {
    name: string;
    description: string;
    hashtags: string[];
}

/** æŠ•ç¨¿ãƒ†ãƒ¼ãƒžä¸€è¦§ */
const THEMES: PostTheme[] = [
    {
        name: "ãƒ†ãƒƒã‚¯ãƒ»ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°",
        description: "ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã®è±†çŸ¥è­˜ã€ä¾¿åˆ©ãªãƒ„ãƒ¼ãƒ«ã€æœ€æ–°æŠ€è¡“ãƒˆãƒ¬ãƒ³ãƒ‰ã«ã¤ã„ã¦ã€‚é–‹ç™ºè€…ãŒã€Œã¸ã‡ï¼ã€ã¨æ€ã†ã‚ˆã†ãªå†…å®¹",
        hashtags: ["#ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°", "#ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢", "#Tech"],
    },
    {
        name: "AIãƒ»æ©Ÿæ¢°å­¦ç¿’",
        description: "AIæŠ€è¡“ã®æœ€æ–°å‹•å‘ã€æ—¥å¸¸ã§ã®AIæ´»ç”¨è¡“ã€AIã«é–¢ã™ã‚‹é¢ç™½ã„è€ƒå¯Ÿã‚„è±†çŸ¥è­˜",
        hashtags: ["#AI", "#ç”ŸæˆAI", "#ChatGPT"],
    },
    {
        name: "ç”Ÿç”£æ€§ãƒ»ãƒ©ã‚¤ãƒ•ãƒãƒƒã‚¯",
        description: "ä»•äº‹ã‚„æ—¥å¸¸ã®åŠ¹çŽ‡ã‚’ä¸Šã’ã‚‹ã‚³ãƒ„ã€æ™‚é–“ç®¡ç†è¡“ã€ãŠã™ã™ã‚ã®ãƒ„ãƒ¼ãƒ«ã‚„ã‚¢ãƒ—ãƒªç´¹ä»‹",
        hashtags: ["#ç”Ÿç”£æ€§å‘ä¸Š", "#ãƒ©ã‚¤ãƒ•ãƒãƒƒã‚¯"],
    },
    {
        name: "ã‚­ãƒ£ãƒªã‚¢ãƒ»è‡ªå·±æˆé•·",
        description: "ã‚­ãƒ£ãƒªã‚¢ã‚¢ãƒƒãƒ—ã®ãƒ’ãƒ³ãƒˆã€å­¦ç¿’æ³•ã€ãƒ¢ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ç®¡ç†ã€åƒãæ–¹ã«ã¤ã„ã¦",
        hashtags: ["#ã‚­ãƒ£ãƒªã‚¢", "#è‡ªå·±æˆé•·"],
    },
    {
        name: "æ—¥å¸¸ã®æ°—ã¥ããƒ»é›‘å­¦",
        description: "æ—¥å¸¸ç”Ÿæ´»ã®ä¸­ã§ã®ã¡ã‚‡ã£ã¨ã—ãŸç™ºè¦‹ã€é¢ç™½ã„é›‘å­¦ã€å…±æ„Ÿã‚’å‘¼ã¶ã‚ã‚‹ã‚ã‚‹ãƒã‚¿",
        hashtags: ["#é›‘å­¦", "#ä»Šæ—¥ã®ä¸€è¨€"],
    },
    {
        name: "æ›¸ç±ãƒ»å­¦ã³",
        description: "ãŠã™ã™ã‚ã®æœ¬ã®ç´¹ä»‹ï¼ˆæž¶ç©ºã§ã‚‚OKï¼‰ã€èª­æ›¸ã‹ã‚‰å¾—ãŸå­¦ã³ã€åè¨€ã®ç´¹ä»‹",
        hashtags: ["#èª­æ›¸", "#ãŠã™ã™ã‚æœ¬"],
    },
    {
        name: "é€±æœ«ãƒ»è¶£å‘³",
        description: "é€±æœ«ã®éŽã”ã—æ–¹ææ¡ˆã€è¶£å‘³ã®æ¥½ã—ã¿æ–¹ã€ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥æ–¹æ³•",
        hashtags: ["#é€±æœ«", "#è¶£å‘³"],
    },
    {
        name: "ãƒ¢ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³",
        description: "é ‘å¼µã£ã¦ã„ã‚‹äººã¸ã®å¿œæ´ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€å‰å‘ããªè¨€è‘‰ã€æœˆæ›œæ—¥ã®æœã«èª­ã¿ãŸã„ä¸€è¨€",
        hashtags: ["#ä»Šæ—¥ã‚‚é ‘å¼µã‚ã†", "#ãƒ¢ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³"],
    },
];

/** æ™‚é–“å¸¯ã«å¿œã˜ãŸæŠ•ç¨¿ãƒˆãƒ¼ãƒ³ */
interface TimeTone {
    period: string;
    instruction: string;
}

function getTimeTone(): TimeTone {
    const hour = new Date().getHours();

    if (hour >= 5 && hour < 11) {
        return { period: "æœ", instruction: "æœã®çˆ½ã‚„ã‹ã•ã‚’æ„Ÿã˜ã‚‹ãƒã‚¸ãƒ†ã‚£ãƒ–ãªãƒˆãƒ¼ãƒ³ã§ã€‚ã€ŒãŠã¯ã‚ˆã†ã”ã–ã„ã¾ã™ã€ç³»ã®æŒ¨æ‹¶ã‚’è‡ªç„¶ã«å«ã‚ã¦ã‚‚OK" };
    } else if (hour >= 11 && hour < 15) {
        return { period: "æ˜¼", instruction: "ã‚«ã‚¸ãƒ¥ã‚¢ãƒ«ã§è»½å¿«ãªãƒˆãƒ¼ãƒ³ã€‚ãƒ©ãƒ³ãƒã‚¿ã‚¤ãƒ ã«æ°—è»½ã«èª­ã‚ã‚‹å†…å®¹ã§" };
    } else if (hour >= 15 && hour < 21) {
        return { period: "å¤•æ–¹ã€œå¤œ", instruction: "1æ—¥ã‚’æŒ¯ã‚Šè¿”ã‚‹ã‚ˆã†ãªè½ã¡ç€ã„ãŸãƒˆãƒ¼ãƒ³ã€‚ã€Œä»Šæ—¥ã‚‚ãŠç–²ã‚Œã•ã¾ã§ã—ãŸã€ç³»ã®å…±æ„Ÿã‚’å«ã‚ã¦ã‚‚OK" };
    } else {
        return { period: "æ·±å¤œ", instruction: "ã—ã£ã¨ã‚Šã¨ã€å°‘ã—å“²å­¦çš„ãªãƒˆãƒ¼ãƒ³ã€‚å¤œæ›´ã‹ã—ã®äººã«åˆºã•ã‚‹ã‚ˆã†ãªå†…å®¹ã§" };
    }
}

function pickRandomTheme(): PostTheme {
    const index = Math.floor(Math.random() * THEMES.length);
    return THEMES[index];
}

export function buildPrompt(): string {
    const theme = pickRandomTheme();
    const tone = getTimeTone();
    const hashtagList = theme.hashtags.join(" ");

    return `ã‚ãªãŸã¯Xï¼ˆæ—§Twitterï¼‰ã®äººæ°—æ—¥æœ¬èªžã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’é‹ç”¨ã™ã‚‹SNSãƒžãƒ¼ã‚±ã‚¿ãƒ¼ã§ã™ã€‚
ä»¥ä¸‹ã®æ¡ä»¶ã«å¾“ã£ã¦ã€ãƒ„ã‚¤ãƒ¼ãƒˆã‚’ **1ã¤ã ã‘** ç”Ÿæˆã—ã¦ãã ã•ã„ã€‚

## æ¡ä»¶
- ãƒ†ãƒ¼ãƒž: ${theme.name}ï¼ˆ${theme.description}ï¼‰
- æ–‡å­—æ•°: **140æ–‡å­—ä»¥å†…**ï¼ˆæ—¥æœ¬èªžã€‚ã“ã‚Œã¯åŽ³å®ˆã—ã¦ãã ã•ã„ï¼‰
- ãƒˆãƒ¼ãƒ³: ${tone.instruction}
- æ™‚é–“å¸¯: ç¾åœ¨ã¯ã€Œ${tone.period}ã€ã§ã™
- ãƒãƒƒã‚·ãƒ¥ã‚¿ã‚°: ä»¥ä¸‹ã‹ã‚‰1ã€œ2å€‹ã‚’è‡ªç„¶ã«æœ«å°¾ã«ä»˜ã‘ã¦ãã ã•ã„ â†’ ${hashtagList}
- çµµæ–‡å­—ã‚’1ã€œ3å€‹ã€é©åº¦ã«ä½¿ã£ã¦ãã ã•ã„
- ãƒ•ã‚©ãƒ­ãƒ¯ãƒ¼ãŒã€Œã„ã„ã­ã€ã‚„ãƒªãƒ„ã‚¤ãƒ¼ãƒˆã—ãŸããªã‚‹ã‚ˆã†ãªã€å…±æ„Ÿãƒ»ç™ºè¦‹ã®ã‚ã‚‹å†…å®¹ã«ã—ã¦ãã ã•ã„
- å®£ä¼ã‚„æŠ¼ã—å£²ã‚Šæ„Ÿã®ãªã„ã€è‡ªç„¶ã§è¦ªã—ã¿ã‚„ã™ã„æ–‡ä½“ã«ã—ã¦ãã ã•ã„

## å‡ºåŠ›å½¢å¼
- ãƒ„ã‚¤ãƒ¼ãƒˆæœ¬æ–‡ã®ã¿ã‚’å‡ºåŠ›ã—ã¦ãã ã•ã„
- å…ˆé ­ã‚„æœ«å°¾ã«ã€Œã€ã‚„å¼•ç”¨ç¬¦ã‚’ä»˜ã‘ãªã„ã§ãã ã•ã„
- èª¬æ˜Žã‚„è£œè¶³ã¯ä¸€åˆ‡ä¸è¦ã§ã™
- æ”¹è¡Œã¯æœ€å°é™ã«ã—ã¦ãã ã•ã„`;
}

export function logPromptInfo(): void {
    const theme = pickRandomTheme();
    const tone = getTimeTone();
    console.log(`ðŸ“ ãƒ†ãƒ¼ãƒž: ${theme.name}`);
    console.log(`ðŸ• æ™‚é–“å¸¯: ${tone.period}`);
    console.log(`ðŸŽ¨ ãƒˆãƒ¼ãƒ³: ${tone.instruction}`);
}
